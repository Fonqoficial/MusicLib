---
interface Props {
  currentInstrument?: string;
  currentDifficulty?: string;
}

const { currentInstrument, currentDifficulty } = Astro.props;

const instruments = [
  'Piano', 'Guitarra', 'Violín', 'Violonchelo', 'Flauta', 
  'Clarinete', 'Trompeta', 'Saxofón', 'Orquesta', 'Coro', 'Cuerdas'
];

const difficulties = [
  { value: 'beginner', label: 'Principiante' },
  { value: 'intermediate', label: 'Intermedio' },
  { value: 'advanced', label: 'Avanzado' },
  { value: 'expert', label: 'Experto' },
];
---

<div class="bg-white rounded-lg shadow-sm p-6 mb-8">
  <form method="GET" class="grid grid-cols-1 md:grid-cols-3 gap-4">
    
    <!-- Instrumento -->
    <div>
      <label for="instrument" class="block text-sm font-medium text-gray-700 mb-2">
        Instrumento
      </label>
      <select 
        id="instrument"
        name="instrument"
        class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"
      >
        <option value="">Todos los instrumentos</option>
        {instruments.map(instrument => (
          <option value={instrument} selected={currentInstrument === instrument}>
            {instrument}
          </option>
        ))}
      </select>
    </div>

    <!-- Dificultad -->
    <div>
      <label for="difficulty" class="block text-sm font-medium text-gray-700 mb-2">
        Dificultad
      </label>
      <select 
        id="difficulty"
        name="difficulty"
        class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"
      >
        <option value="">Todas las dificultades</option>
        {difficulties.map(diff => (
          <option value={diff.value} selected={currentDifficulty === diff.value}>
            {diff.label}
          </option>
        ))}
      </select>
    </div>

    <!-- Botones -->
    <div class="flex items-end gap-2">
      <button
        type="submit"
        class="btn-primary flex-1"
      >
        Filtrar
      </button>
      <a
        href="/partituras"
        class="btn-secondary px-4 py-2"
      >
        Limpiar
      </a>
    </div>

  </form>
</div>

<script>
  // Auto-submit al cambiar select
  const selects = document.querySelectorAll('select');
  selects.forEach(select => {
    select.addEventListener('change', () => {
      select.closest('form')?.requestSubmit();
    });
  });
</script>